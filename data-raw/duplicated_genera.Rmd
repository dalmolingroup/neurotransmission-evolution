---
title: "Duplicated genera"
knit: neurotransmissionevolution::custom_knit
---
```{r setup, include=FALSE}
knitr::opts_chunk$set(
  warning     = FALSE,
  message     = FALSE,
  cache       = TRUE,
  cache.extra = file.mtime("download/taxdump.tar.gz")
)

library(tidyverse)
library(igraph)
library(tidylog)
library(magrittr)
library(neurotransmissionevolution)
```

#### **Loading data**
` `  
See \hyperref[tab:ncbi_edgelist]{Table 3} and \hyperref[tab:ncbi_taxon_names]{Table 4}.
```{r}
taxid_rank <- read_delim(
  "download/taxdump/nodes.dmp",
  skip = 1,
  delim = "|",
  trim_ws = TRUE,
  col_names = c("taxid","rank"),
  col_types = "c-c"
)

ncbi_taxon_names <- read_delim(
  "download/taxdump/names.dmp",
  delim = "|",
  trim_ws = TRUE,
  col_names = c("taxid","ncbi_name","type"),
  col_types = "cc-c"
)
```

#### **Finding duplicated genera**
` `  
```{r}
# keeping genera nodes
taxid_rank %<>% filter(rank == "genus")

# keeping scientific names
ncbi_taxon_names %<>%
  filter(type == "scientific name") %>%
  select(taxid, ncbi_name) %>%
  inner_join(taxid_rank)

# extracting and saving duplicated values
duplicated_genera <- ncbi_taxon_names %>%
  pull(ncbi_name) %>%
  extract(duplicated(.)) %>%
  write("duplicated_genera.txt")
```
